# Runner Tool Usage Examples

The `runner` tool is a diagnostic tool that helps you get fresh logs from running development servers by making HTTP calls and capturing the resulting log output. It can also list all currently running processes.

## Basic Usage

### List all running processes

```typescript
// Get information about all current processes
await runner.execute({});
```

This will return a list of all currently running processes with their details including:
- Process ID
- Name
- Status
- Server URL
- Command
- Working directory
- Process ID (PID)
- Uptime
- Start time

### Get logs from a specific process

```typescript
// Get diagnostic information from a process
await runner.execute({
  processId: "my-dev-server"
});
```

This will:
1. Get server information for the process
2. Capture current logs
3. Make an HTTP GET request to the root endpoint (`/`)
4. Capture new logs after the request
5. Return only the fresh logs generated by the HTTP call

## Advanced Usage

### Custom endpoint and HTTP method

```typescript
// Test a specific API endpoint
await runner.execute({
  processId: "api-server",
  endpoint: "/api/health",
  method: "POST"
});
```

### With custom timeout

```typescript
// Use a longer timeout for slow endpoints
await runner.execute({
  processId: "slow-server",
  endpoint: "/heavy-computation",
  timeout: 30000 // 30 seconds
});
```

## Common Use Cases

### 1. Discovery - List All Processes

Start by discovering what processes are currently running:

```typescript
await runner.execute({});
```

Expected output:
```
Current Running Processes (2):

1. Process ID: next-dev-123
   Name: Next.js Development Server
   Status: active
   URL: http://localhost:3000
   Command: npm run dev
   CWD: /path/to/project
   PID: 12345
   Uptime: 120 seconds
   Start Time: 2023-12-01T10:28:15.000Z

2. Process ID: api-server-456
   Name: Express API Server
   Status: active
   URL: http://localhost:8080
   Command: node server.js
   CWD: /path/to/api
   PID: 12346
   Uptime: 85 seconds
   Start Time: 2023-12-01T10:28:50.000Z

To get diagnostic logs for a specific process, use:
runner({ processId: "process-id" })
```

### 2. Debugging API Endpoints

When you need to see what logs are generated when hitting a specific endpoint:

```typescript
await runner.execute({
  processId: "backend-api",
  endpoint: "/api/users",
  method: "GET"
});
```

### 3. Testing Error Handling

See how your server handles and logs errors:

```typescript
await runner.execute({
  processId: "web-server",
  endpoint: "/invalid-route",
  method: "GET"
});
```

### 4. Health Checks

Verify your server is responding and logging correctly:

```typescript
await runner.execute({
  processId: "production-server",
  endpoint: "/health",
  method: "GET"
});
```

## Expected Output

### Process Listing Output

When called without `processId`:

```
Current Running Processes (1):

1. Process ID: my-dev-server
   Name: Next.js Dev Server
   Status: active
   URL: http://localhost:3000
   Command: npm run dev
   CWD: /Users/dev/my-project
   PID: 12345
   Uptime: 45 seconds
   Start Time: 2023-12-01T10:29:30.000Z

To get diagnostic logs for a specific process, use:
runner({ processId: "process-id" })
```

### Diagnostic Output

When called with a specific `processId`:

```
Runner Diagnostic for Process: my-dev-server
Server: Next.js Dev Server (active)
URL: http://localhost:3000
Uptime: 45 seconds

HTTP Call Result:
HTTP GET http://localhost:3000/ - Status: 200 OK
Response body: <!DOCTYPE html><html>...

Fresh Logs (3 new entries):
[2023-12-01T10:30:15.123Z] STDOUT: GET / 200 - 45ms
[2023-12-01T10:30:15.125Z] STDOUT: Compiled successfully
[2023-12-01T10:30:15.127Z] STDOUT: Request processed in 47ms
```

## Error Scenarios

### No processes running
```
No running processes found. Start a development server first using one of the available runner commands.
```

### Process not found
```
Error: Process with ID 'non-existent' not found. Use the runner tool without processId to list all running processes.
```

### Process not active
```
Error: Process 'stopped-server' is not active. Current status: stopped
```

### No server URL
```
Error: No server URL found for process 'background-task'. The process might not be a web server.
```

### HTTP request failed
```
Runner Diagnostic for Process: broken-server
Server: Express Server (active)
URL: http://localhost:3000
Uptime: 120 seconds

HTTP Call Result:
HTTP GET http://localhost:3000/ - Error: Connection refused

No new logs generated from the HTTP call.
```

## Workflow

Here's a typical workflow for using the runner tool:

```typescript
// 1. First, discover what processes are running
await runner.execute({});

// 2. Pick a process ID from the list and test it
await runner.execute({
  processId: "next-dev-123",
  endpoint: "/",
  method: "GET"
});

// 3. Test specific endpoints
await runner.execute({
  processId: "next-dev-123",
  endpoint: "/api/users",
  method: "POST"
});

// 4. Test with different timeouts if needed
await runner.execute({
  processId: "next-dev-123",
  endpoint: "/slow-endpoint",
  timeout: 30000
});
```

## Tips

1. **Start with Process Discovery**: Always begin by calling `runner()` without parameters to see what's running
2. **Use Process IDs**: Copy the exact process ID from the listing to avoid typos
3. **Test Basic Connectivity**: Start with the root endpoint (`/`) to ensure basic connectivity
4. **Check Server Status**: Look for processes with `active` status and valid URLs
5. **Use Appropriate Timeouts**: Adjust timeout based on your server's expected response time
6. **Monitor Different Endpoints**: Test various endpoints to understand server behavior

## Quick Reference

### List all processes
```typescript
await runner.execute({});
```

### Test specific process
```typescript
await runner.execute({
  processId: "my-server-id"
});
```

### Test with custom endpoint
```typescript
await runner.execute({
  processId: "my-server-id",
  endpoint: "/api/health",
  method: "POST",
  timeout: 15000
});
```

## Integration with Other Tools

The runner tool works well with other diagnostic tools:

```typescript
// Start by listing all processes
await runner.execute({});

// Test a specific server
await runner.execute({
  processId: "found-process-id",
  endpoint: "/api/status"
});

// Get additional system information if needed
await terminal.execute({
  command: "netstat -tulpn | grep :3000",
  cd: "project-root"
});
```
